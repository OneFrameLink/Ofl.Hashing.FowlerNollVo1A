using System.Runtime.InteropServices;
using Xunit;

namespace Ofl.Hashing.FowlerNollVo1A.Tests
{
    public class FowlerNollVo1A64BitHashAlgorithmTests
    {
        #region Tests.

        [Theory]
        [InlineData("", false, 0xcbf29ce484222325, null)]
        [InlineData("a", false, 0xaf63dc4c8601ec8c, null)]
        [InlineData("b", false, 0xaf63df4c8601f1a5, null)]
        [InlineData("c", false, 0xaf63de4c8601eff2, null)]
        [InlineData("d", false, 0xaf63d94c8601e773, null)]
        [InlineData("e", false, 0xaf63d84c8601e5c0, null)]
        [InlineData("f", false, 0xaf63db4c8601ead9, null)]
        [InlineData("fo", false, 0x08985907b541d342, null)]
        [InlineData("foo", false, 0xdcb27518fed9d577, null)]
        [InlineData("foob", false, 0xdd120e790c2512af, null)]
        [InlineData("fooba", false, 0xcac165afa2fef40a, null)]
        [InlineData("foobar", false, 0x85944171f73967e8, null)]
        [InlineData("", true, 0xaf63bd4c8601b7df, null)]
        [InlineData("a", true, 0x089be207b544f1e4, null)]
        [InlineData("b", true, 0x08a61407b54d9b5f, null)]
        [InlineData("c", true, 0x08a2ae07b54ab836, null)]
        [InlineData("d", true, 0x0891b007b53c4869, null)]
        [InlineData("e", true, 0x088e4a07b5396540, null)]
        [InlineData("f", true, 0x08987c07b5420ebb, null)]
        [InlineData("fo", true, 0xdcb28a18fed9f926, null)]
        [InlineData("foo", true, 0xdd1270790c25b935, null)]
        [InlineData("foob", true, 0xcac146afa2febf5d, null)]
        [InlineData("fooba", true, 0x8593d371f738acfe, null)]
        [InlineData("foobar", true, 0x34531ca7168b8f38, null)]
        [InlineData("ch", false, 0x08a25607b54a22ae, null)]
        [InlineData("cho", false, 0xf5faf0190cf90df3, null)]
        [InlineData("chon", false, 0xf27397910b3221c7, null)]
        [InlineData("chong", false, 0x2c8c2b76062f22e0, null)]
        [InlineData("chongo", false, 0xe150688c8217b8fd, null)]
        [InlineData("chongo ", false, 0xf35a83c10e4f1f87, null)]
        [InlineData("chongo w", false, 0xd1edd10b507344d0, null)]
        [InlineData("chongo wa", false, 0x2a5ee739b3ddb8c3, null)]
        [InlineData("chongo was", false, 0xdcfb970ca1c0d310, null)]
        [InlineData("chongo was ", false, 0x4054da76daa6da90, null)]
        [InlineData("chongo was h", false, 0xf70a2ff589861368, null)]
        [InlineData("chongo was he", false, 0x4c628b38aed25f17, null)]
        [InlineData("chongo was her", false, 0x9dd1f6510f78189f, null)]
        [InlineData("chongo was here", false, 0xa3de85bd491270ce, null)]
        [InlineData("chongo was here!", false, 0x858e2fa32a55e61d, null)]
        [InlineData("chongo was here!\n", false, 0x46810940eff5f915, null)]
        [InlineData("ch", true, 0xf5fadd190cf8edaa, null)]
        [InlineData("cho", true, 0xf273ed910b32b3e9, null)]
        [InlineData("chon", true, 0x2c8c5276062f6525, null)]
        [InlineData("chong", true, 0xe150b98c821842a0, null)]
        [InlineData("chongo", true, 0xf35aa3c10e4f55e7, null)]
        [InlineData("chongo ", true, 0xd1ed680b50729265, null)]
        [InlineData("chongo w", true, 0x2a5f0639b3dded70, null)]
        [InlineData("chongo wa", true, 0xdcfbaa0ca1c0f359, null)]
        [InlineData("chongo was", true, 0x4054ba76daa6a430, null)]
        [InlineData("chongo was ", true, 0xf709c7f5898562b0, null)]
        [InlineData("chongo was h", true, 0x4c62e638aed2f9b8, null)]
        [InlineData("chongo was he", true, 0x9dd1a8510f779415, null)]
        [InlineData("chongo was her", true, 0xa3de2abd4911d62d, null)]
        [InlineData("chongo was here", true, 0x858e0ea32a55ae0a, null)]
        [InlineData("chongo was here!", true, 0x46810f40eff60347, null)]
        [InlineData("chongo was here!\n", true, 0xc33bce57bef63eaf, null)]
        [InlineData("cu", false, 0x08a24307b54a0265, null)]
        [InlineData("cur", false, 0xf5b9fd190cc18d15, null)]
        [InlineData("curd", false, 0x4c968290ace35703, null)]
        [InlineData("curds", false, 0x07174bd5c64d9350, null)]
        [InlineData("curds ", false, 0x5a294c3ff5d18750, null)]
        [InlineData("curds a", false, 0x05b3c1aeb308b843, null)]
        [InlineData("curds an", false, 0xb92a48da37d0f477, null)]
        [InlineData("curds and", false, 0x73cdddccd80ebc49, null)]
        [InlineData("curds and ", false, 0xd58c4c13210a266b, null)]
        [InlineData("curds and w", false, 0xe78b6081243ec194, null)]
        [InlineData("curds and wh", false, 0xb096f77096a39f34, null)]
        [InlineData("curds and whe", false, 0xb425c54ff807b6a3, null)]
        [InlineData("curds and whey", false, 0x23e520e2751bb46e, null)]
        [InlineData("curds and whey\n", false, 0x1a0b44ccfe1385ec, null)]
        [InlineData("cu", true, 0xf5ba4b190cc2119f, null)]
        [InlineData("cur", true, 0x4c962690ace2baaf, null)]
        [InlineData("curd", true, 0x0716ded5c64cda19, null)]
        [InlineData("curds", true, 0x5a292c3ff5d150f0, null)]
        [InlineData("curds ", true, 0x05b3e0aeb308ecf0, null)]
        [InlineData("curds a", true, 0xb92a5eda37d119d9, null)]
        [InlineData("curds an", true, 0x73ce41ccd80f6635, null)]
        [InlineData("curds and", true, 0xd58c2c132109f00b, null)]
        [InlineData("curds and ", true, 0xe78baf81243f47d1, null)]
        [InlineData("curds and w", true, 0xb0968f7096a2ee7c, null)]
        [InlineData("curds and wh", true, 0xb425a84ff807855c, null)]
        [InlineData("curds and whe", true, 0x23e4e9e2751b56f9, null)]
        [InlineData("curds and whey", true, 0x1a0b4eccfe1396ea, null)]
        [InlineData("curds and whey\n", true, 0x54abd453bb2c9004, null)]
        [InlineData("hi", false, 0x08ba5f07b55ec3da, null)]
        [InlineData("hi", true, 0x337354193006cb6e, null)]
        [InlineData("hello", false, 0xa430d84680aabd0b, null)]
        [InlineData("hello", true, 0xa9bc8acca21f39b1, null)]
        [InlineData(new byte[] { 0xff, 0x00, 0x00, 0x01 }, false, 0x6961196491cc682d, null)]
        [InlineData(new byte[] { 0x01, 0x00, 0x00, 0xff }, false, 0xad2bb1774799dfe9, null)]
        [InlineData(new byte[] { 0xff, 0x00, 0x00, 0x02 }, false, 0x6961166491cc6314, null)]
        [InlineData(new byte[] { 0x02, 0x00, 0x00, 0xff }, false, 0x8d1bb3904a3b1236, null)]
        [InlineData(new byte[] { 0xff, 0x00, 0x00, 0x03 }, false, 0x6961176491cc64c7, null)]
        [InlineData(new byte[] { 0x03, 0x00, 0x00, 0xff }, false, 0xed205d87f40434c7, null)]
        [InlineData(new byte[] { 0xff, 0x00, 0x00, 0x04 }, false, 0x6961146491cc5fae, null)]
        [InlineData(new byte[] { 0x04, 0x00, 0x00, 0xff }, false, 0xcd3baf5e44f8ad9c, null)]
        [InlineData(new byte[] { 0x40, 0x51, 0x4e, 0x44 }, false, 0xe3b36596127cd6d8, null)]
        [InlineData(new byte[] { 0x44, 0x4e, 0x51, 0x40 }, false, 0xf77f1072c8e8a646, null)]
        [InlineData(new byte[] { 0x40, 0x51, 0x4e, 0x4a }, false, 0xe3b36396127cd372, null)]
        [InlineData(new byte[] { 0x4a, 0x4e, 0x51, 0x40 }, false, 0x6067dce9932ad458, null)]
        [InlineData(new byte[] { 0x40, 0x51, 0x4e, 0x54 }, false, 0xe3b37596127cf208, null)]
        [InlineData(new byte[] { 0x54, 0x4e, 0x51, 0x40 }, false, 0x4b7b10fa9fe83936, null)]
        [InlineData("127.0.0.1", false, 0xaabafe7104d914be, null)]
        [InlineData("127.0.0.1", true, 0xf4d3180b3cde3eda, null)]
        [InlineData("127.0.0.2", false, 0xaabafd7104d9130b, null)]
        [InlineData("127.0.0.2", true, 0xf4cfb20b3cdb5bb1, null)]
        [InlineData("127.0.0.3", false, 0xaabafc7104d91158, null)]
        [InlineData("127.0.0.3", true, 0xf4cc4c0b3cd87888, null)]
        [InlineData("64.81.78.68", false, 0xe729bac5d2a8d3a7, null)]
        [InlineData("64.81.78.68", true, 0x74bc0524f4dfa4c5, null)]
        [InlineData("64.81.78.74", false, 0xe72630c5d2a5b352, null)]
        [InlineData("64.81.78.74", true, 0x6b983224ef8fb456, null)]
        [InlineData("64.81.78.84", false, 0xe73042c5d2ae266d, null)]
        [InlineData("64.81.78.84", true, 0x8527e324fdeb4b37, null)]
        [InlineData("feedface", false, 0x0a83c86fee952abc, null)]
        [InlineData("feedface", true, 0x7318523267779d74, null)]
        [InlineData("feedfacedaffdeed", false, 0x3e66d3d56b8caca1, null)]
        [InlineData("feedfacedaffdeed", true, 0x956694a5c0095593, null)]
        [InlineData("feedfacedeadbeef", false, 0xcac54572bb1a6fc8, null)]
        [InlineData("feedfacedeadbeef", true, 0xa7a4c9f3edebf0d8, null)]
        [InlineData("line 1\nline 2\nline 3", false, 0x7829851fac17b143, null)]
        [InlineData("chongo <Landon Curt Noll> /\\../\\", false, 0x2c8f4c9af81bcf06, null)]
        [InlineData("chongo <Landon Curt Noll> /\\../\\", true, 0xd34e31539740c732, null)]
        [InlineData("chongo (Landon Curt Noll) /\\../\\", false, 0x3605a2ac253d2db1, null)]
        [InlineData("chongo (Landon Curt Noll) /\\../\\", true, 0x08c11b8346f4a3c3, null)]
        [InlineData("http://antwrp.gsfc.nasa.gov/apod/astropix.html", false, 0x6be396289ce8a6da, null)]
        [InlineData("http://en.wikipedia.org/wiki/Fowler_Noll_Vo_hash", false, 0xd9b957fb7fe794c5, null)]
        [InlineData("http://epod.usra.edu/", false, 0x05be33da04560a93, null)]
        [InlineData("http://exoplanet.eu/", false, 0x0957f1577ba9747c, null)]
        [InlineData("http://hvo.wr.usgs.gov/cam3/", false, 0xda2cc3acc24fba57, null)]
        [InlineData("http://hvo.wr.usgs.gov/cams/HMcam/", false, 0x74136f185b29e7f0, null)]
        [InlineData("http://hvo.wr.usgs.gov/kilauea/update/deformation.html", false, 0xb2f2b4590edb93b2, null)]
        [InlineData("http://hvo.wr.usgs.gov/kilauea/update/images.html", false, 0xb3608fce8b86ae04, null)]
        [InlineData("http://hvo.wr.usgs.gov/kilauea/update/maps.html", false, 0x4a3a865079359063, null)]
        [InlineData("http://hvo.wr.usgs.gov/volcanowatch/current_issue.html", false, 0x5b3a7ef496880a50, null)]
        [InlineData("http://neo.jpl.nasa.gov/risk/", false, 0x48fae3163854c23b, null)]
        [InlineData("http://norvig.com/21-days.html", false, 0x07aaa640476e0b9a, null)]
        [InlineData("http://primes.utm.edu/curios/home.php", false, 0x2f653656383a687d, null)]
        [InlineData("http://slashdot.org/", false, 0xa1031f8e7599d79c, null)]
        [InlineData("http://tux.wr.usgs.gov/Maps/155.25-19.5.html", false, 0xa31908178ff92477, null)]
        [InlineData("http://volcano.wr.usgs.gov/kilaueastatus.php", false, 0x097edf3c14c3fb83, null)]
        [InlineData("http://www.avo.alaska.edu/activity/Redoubt.php", false, 0xb51ca83feaa0971b, null)]
        [InlineData("http://www.dilbert.com/fast/", false, 0xdd3c0d96d784f2e9, null)]
        [InlineData("http://www.fourmilab.ch/gravitation/orbits/", false, 0x86cd26a9ea767d78, null)]
        [InlineData("http://www.fpoa.net/", false, 0xe6b215ff54a30c18, null)]
        [InlineData("http://www.ioccc.org/index.html", false, 0xec5b06a1c5531093, null)]
        [InlineData("http://www.isthe.com/cgi-bin/number.cgi", false, 0x45665a929f9ec5e5, null)]
        [InlineData("http://www.isthe.com/chongo/bio.html", false, 0x8c7609b4a9f10907, null)]
        [InlineData("http://www.isthe.com/chongo/index.html", false, 0x89aac3a491f0d729, null)]
        [InlineData("http://www.isthe.com/chongo/src/calc/lucas-calc", false, 0x32ce6b26e0f4a403, null)]
        [InlineData("http://www.isthe.com/chongo/tech/astro/venus2004.html", false, 0x614ab44e02b53e01, null)]
        [InlineData("http://www.isthe.com/chongo/tech/astro/vita.html", false, 0xfa6472eb6eef3290, null)]
        [InlineData("http://www.isthe.com/chongo/tech/comp/c/expert.html", false, 0x9e5d75eb1948eb6a, null)]
        [InlineData("http://www.isthe.com/chongo/tech/comp/calc/index.html", false, 0xb6d12ad4a8671852, null)]
        [InlineData("http://www.isthe.com/chongo/tech/comp/fnv/index.html", false, 0x88826f56eba07af1, null)]
        [InlineData("http://www.isthe.com/chongo/tech/math/number/howhigh.html", false, 0x44535bf2645bc0fd, null)]
        [InlineData("http://www.isthe.com/chongo/tech/math/number/number.html", false, 0x169388ffc21e3728, null)]
        [InlineData("http://www.isthe.com/chongo/tech/math/prime/mersenne.html", false, 0xf68aac9e396d8224, null)]
        [InlineData("http://www.isthe.com/chongo/tech/math/prime/mersenne.html#largest", false, 0x8e87d7e7472b3883, null)]
        [InlineData("http://www.lavarnd.org/cgi-bin/corpspeak.cgi", false, 0x295c26caa8b423de, null)]
        [InlineData("http://www.lavarnd.org/cgi-bin/haiku.cgi", false, 0x322c814292e72176, null)]
        [InlineData("http://www.lavarnd.org/cgi-bin/rand-none.cgi", false, 0x8a06550eb8af7268, null)]
        [InlineData("http://www.lavarnd.org/cgi-bin/randdist.cgi", false, 0xef86d60e661bcf71, null)]
        [InlineData("http://www.lavarnd.org/index.html", false, 0x9e5426c87f30ee54, null)]
        [InlineData("http://www.lavarnd.org/what/nist-test.html", false, 0xf1ea8aa826fd047e, null)]
        [InlineData("http://www.macosxhints.com/", false, 0x0babaf9a642cb769, null)]
        [InlineData("http://www.mellis.com/", false, 0x4b3341d4068d012e, null)]
        [InlineData("http://www.nature.nps.gov/air/webcams/parks/havoso2alert/havoalert.cfm", false, 0xd15605cbc30a335c, null)]
        [InlineData("http://www.nature.nps.gov/air/webcams/parks/havoso2alert/timelines_24.cfm", false, 0x5b21060aed8412e5, null)]
        [InlineData("http://www.paulnoll.com/", false, 0x45e2cda1ce6f4227, null)]
        [InlineData("http://www.pepysdiary.com/", false, 0x50ae3745033ad7d4, null)]
        [InlineData("http://www.sciencenews.org/index/home/activity/view", false, 0xaa4588ced46bf414, null)]
        [InlineData("http://www.skyandtelescope.com/", false, 0xc1b0056c4a95467e, null)]
        [InlineData("http://www.sput.nl/~rob/sirius.html", false, 0x56576a71de8b4089, null)]
        [InlineData("http://www.systemexperts.com/", false, 0xbf20965fa6dc927e, null)]
        [InlineData("http://www.tq-international.com/phpBB3/index.php", false, 0x569f8383c2040882, null)]
        [InlineData("http://www.travelquesttours.com/index.htm", false, 0xe1e772fba08feca0, null)]
        [InlineData("http://www.wunderground.com/global/stations/89606.html", false, 0x4ced94af97138ac4, null)]
        [InlineData("21701", false, 0xc4112ffb337a82fb, 10)]
        [InlineData("M21701", false, 0xd64a4fd41de38b7d, 10)]
        [InlineData("2^21701-1", false, 0x4cfc32329edebcbb, 10)]
        [InlineData(new byte[] { 0x54, 0xc5 }, false, 0x0803564445050395, 10)]
        [InlineData(new byte[] { 0xc5, 0x54 }, false, 0xaa1574ecf4642ffd, 10)]
        [InlineData("23209", false, 0x694bc4e54cc315f9, 10)]
        [InlineData("M23209", false, 0xa3d7cb273b011721, 10)]
        [InlineData("2^23209-1", false, 0x577c2f8b6115bfa5, 10)]
        [InlineData(new byte[] { 0x5a, 0xa9 }, false, 0xb7ec8c1a769fb4c1, 10)]
        [InlineData(new byte[] { 0xa9, 0x5a }, false, 0x5d5cfce63359ab19, 10)]
        [InlineData("391581216093", false, 0x33b96c3cd65b5f71, 10)]
        [InlineData("391581*2^216093-1", false, 0xd845097780602bb9, 10)]
        [InlineData(new byte[] { 0x05, 0xf9, 0x9d, 0x03, 0x4c, 0x81 }, false, 0x84d47645d02da3d5, 10)]
        [InlineData("FEDCBA9876543210", false, 0x83544f33b58773a5, 10)]
        [InlineData(new byte[] { 0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10 }, false, 0x9175cbb2160836c5, 10)]
        [InlineData("EFCDAB8967452301", false, 0xc71b3bc175e72bc5, 10)]
        [InlineData(new byte[] { 0xef, 0xcd, 0xab, 0x89, 0x67, 0x45, 0x23, 0x01 }, false, 0x636806ac222ec985, 10)]
        [InlineData("0123456789ABCDEF", false, 0xb6ef0e6950f52ed5, 10)]
        [InlineData(new byte[] { 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef }, false, 0xead3d8a0f3dfdaa5, 10)]
        [InlineData("1032547698BADCFE", false, 0x922908fe9a861ba5, 10)]
        [InlineData(new byte[] { 0x10, 0x32, 0x54, 0x76, 0x98, 0xba, 0xdc, 0xfe }, false, 0x6d4821de275fd5c5, 10)]
        [InlineData(0x00, false, 0x1fe3fce62bd816b5, 500)]
        [InlineData(0x07, false, 0xc23e9fccd6f70591, 500)]
        [InlineData("~", false, 0xc1af12bdfe16b5b5, 500)]
        [InlineData(0x7f, false, 0x39e9f18f2f85e221, 500)]
        public void Test_TransformBlock(object test, bool nullTerminated, ulong expected, int? repeat)
        {
            // Get the bytes.
            byte[] bytes = TestExtensions.GetTestBytes(test, nullTerminated, repeat);

            // Create the hash algorithm.
            IHashAlgorithm hashAlgorithm = new FowlerNollVo1A64BitHashAlgorithm();

            // Hash each character, use each octet in UTF8?
            hashAlgorithm.TransformBlock(bytes);

            // Get the hash, convert and compare.
            Assert.Equal(expected, MemoryMarshal.Read<ulong>(hashAlgorithm.Hash.Span));
        }

        #endregion
    }
}
